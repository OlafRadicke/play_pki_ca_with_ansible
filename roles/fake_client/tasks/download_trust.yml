---

- name:        Download certificate bundle files from the referrenc ca (RedHat & Co)
  get_url:
    url:       "{{ referrenc_ca_url }}/{{ referrenc_ca_name }}.bundle.pem"
    dest:      "/usr/share/pki/ca-trust-source/anchors/{{ referrenc_ca_name }}.bundle.pem"
  when:        ansible_distribution != "Ubuntu"


- name:        Download certificate bundle files from the referrenc ca (RedHat & Co)
  get_url:
    url:       "{{ referrenc_ca_url }}/{{ referrenc_ca_name }}.bundle.pem"
    dest:      "/usr/local/share/ca-certificates/{{ referrenc_ca_name }}.bundle.pem"
  when:        ansible_distribution == "Ubuntu"


###############################################################################

- name:        Update ca trust for RedHat and Co
  shell:       "update-ca-trust"
  register:    shell_result
  when:        ansible_distribution != "Ubuntu"

- name:        Output return value
  debug:
    msg:       "{{ shell_result }}"
  when:        debug_output


###############################################################################

- name:        Update ca trust for Ubuntu
  shell:       "update-ca-certificates"
  register:    shell_result
  when:        ansible_distribution == "Ubuntu"

- name:        Output return value
  debug:
    msg:       "{{ shell_result }}"
  when:        debug_output

###############################################################################

- name:        Get trust list
  shell:       "trust list"
  register:    shell_result
  when:        ansible_distribution != "Ubuntu"

- name:        Output return value
  debug:
    msg:       "{{ shell_result }}"
  when:        debug_output
